# -*- coding: utf-8 -*-
# Generated by Django 1.11.23 on 2019-08-14 14:54


from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
import djtools.db.models
import djtools.middleware.threadlocals


class Migration(migrations.Migration):

    initial = True

    dependencies = [migrations.swappable_dependency(settings.AUTH_USER_MODEL), ('comum', '0002_auto_20190814_1443'), ('rh', '0001_initial')]

    operations = [
        migrations.CreateModel(
            name='Candidato',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('descricao', models.TextField(blank=True, verbose_name='Texto de Apresentação')),
                (
                    'status',
                    djtools.db.models.CharFieldPlus(
                        choices=[('Deferido', 'Deferido'), ('Indeferido', 'Indeferido'), ('Pendente', 'Pendente'), ('Não aplicado', 'Não aplicado')],
                        default='Pendente',
                        max_length=255,
                        verbose_name='Parecer',
                    ),
                ),
                ('justificativa_parecer', models.TextField(blank=True, verbose_name='Justificativa do Parecer')),
                (
                    'campus',
                    djtools.db.models.ForeignKeyPlus(
                        on_delete=django.db.models.deletion.CASCADE, to='rh.UnidadeOrganizacional', verbose_name='Campus do Candidato no Momento da Inscrição'
                    ),
                ),
                ('candidato_vinculo', djtools.db.models.ForeignKeyPlus(on_delete=django.db.models.deletion.CASCADE, to='comum.Vinculo', verbose_name='Candidato')),
            ],
            options={'verbose_name': 'Candidato', 'verbose_name_plural': 'Candidatos', 'permissions': (('validar_candidato', 'Pode validar candidato'),)},
        ),
        migrations.CreateModel(
            name='Chapa',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nome', djtools.db.models.CharFieldPlus(max_length=255, verbose_name='Nome')),
                ('descricao', models.TextField(verbose_name='Descrição')),
                (
                    'status',
                    djtools.db.models.CharFieldPlus(
                        choices=[('Deferido', 'Deferido'), ('Indeferido', 'Indeferido'), ('Pendente', 'Pendente')], default='Pendente', max_length=255, verbose_name='Parecer'
                    ),
                ),
                ('justificativa_parecer', models.TextField(blank=True, verbose_name='Justificativa do Parecer')),
            ],
            options={'verbose_name': 'Chapa', 'verbose_name_plural': 'Chapas', 'permissions': (('validar_chapa', 'Pode validar chapa'),)},
        ),
        migrations.CreateModel(
            name='Edital',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('descricao', djtools.db.models.CharFieldPlus(max_length=255, verbose_name='Descrição')),
                ('data_inscricao_inicio', djtools.db.models.DateTimeFieldPlus(help_text='Período em que os candidatos podem se inscrever.', verbose_name='Início das Inscrições')),
                ('data_inscricao_fim', djtools.db.models.DateTimeFieldPlus(verbose_name='Fim das Inscrições')),
                (
                    'data_validacao_inicio',
                    djtools.db.models.DateTimeFieldPlus(help_text='Período de validação das candidaturas por parte dos Coordenadores.', verbose_name='Início da Validação'),
                ),
                ('data_validacao_fim', djtools.db.models.DateTimeFieldPlus(verbose_name='Fim da Validação')),
                (
                    'data_campanha_inicio',
                    djtools.db.models.DateTimeFieldPlus(help_text='Período em que os candidados são tornados públicos na tela inicial.', verbose_name='Início da Campanha'),
                ),
                ('data_campanha_fim', djtools.db.models.DateTimeFieldPlus(verbose_name='Fim da Campanha')),
                ('data_votacao_inicio', djtools.db.models.DateTimeFieldPlus(help_text='Período em que usuários habilitados podem votar.', verbose_name='Início da Votação')),
                ('data_votacao_fim', djtools.db.models.DateTimeFieldPlus(verbose_name='Fim da Votação')),
                (
                    'data_homologacao_inicio',
                    djtools.db.models.DateTimeFieldPlus(
                        help_text='Período em que os coordenadores podem invalidar os votos em caso de descumprimento do edital.', verbose_name='Início da Homologação'
                    ),
                ),
                ('data_homologacao_fim', djtools.db.models.DateTimeFieldPlus(verbose_name='Fim da Homologação')),
                (
                    'data_pre_resultado_inicio',
                    djtools.db.models.DateTimeFieldPlus(
                        blank=True, help_text='Período em que o resultado preliminar é exibido ao público.', null=True, verbose_name='Início do Resultado Preliminar'
                    ),
                ),
                ('data_pre_resultado_fim', djtools.db.models.DateTimeFieldPlus(blank=True, null=True, verbose_name='Fim do Resultado Preliminar')),
                (
                    'data_resultado_final',
                    djtools.db.models.DateTimeFieldPlus(help_text='O resultado final é exibido somente aos coordenadores.', verbose_name='Data para Resultado Final'),
                ),
                ('coordenadores', models.ManyToManyField(related_name='eleicao_editais', to='rh.Servidor')),
            ],
            options={'verbose_name': 'Edital', 'verbose_name_plural': 'Editais'},
        ),
        migrations.CreateModel(
            name='Eleicao',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('tipo', djtools.db.models.CharFieldPlus(choices=[('Individual', 'Individual'), ('Chapa', 'Chapa')], max_length=255, verbose_name='Tipo')),
                ('descricao', djtools.db.models.CharFieldPlus(max_length=255, verbose_name='Descrição')),
                ('caracteres_campanha', models.PositiveIntegerField(default=2000, verbose_name='Número de caracteres para a campanha')),
                ('caracteres_recurso', models.PositiveIntegerField(default=2000, verbose_name='Número de caracteres para recurso')),
                (
                    'votacao_global',
                    models.BooleanField(default=False, help_text='A votação dessa eleição será sistêmica entre os campi selecionados.', verbose_name='Votação Sistêmica'),
                ),
                (
                    'resultado_global',
                    models.BooleanField(
                        default=False, help_text='O resultado dessa eleição será exibido de forma sistêmica entre os campi selecionados.', verbose_name='Resultado Sistêmico'
                    ),
                ),
                ('obs_voto', models.TextField(blank=True, help_text='Esta observação será visível para o eleitor no momento da votação', verbose_name='Observação para Votação')),
                ('campi', models.ManyToManyField(blank=True, to='rh.UnidadeOrganizacional')),
                ('edital', djtools.db.models.ForeignKeyPlus(on_delete=django.db.models.deletion.CASCADE, to='eleicao.Edital', verbose_name='Edital')),
                (
                    'pessoas_relacionadas_eleicao',
                    djtools.db.models.ManyToManyFieldPlus(blank=True, related_name='pessoas_relacionadas_eleicao', to='rh.Servidor', verbose_name='Pessoas Relacionadas à Eleição'),
                ),
                ('publico', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='comum.Publico', verbose_name='Público')),
                (
                    'vinculo_publico_eleicao',
                    djtools.db.models.ManyToManyFieldPlus(blank=True, related_name='publico_eleicao', to='comum.Vinculo', verbose_name='Público da Eleição'),
                ),
            ],
            options={'verbose_name': 'Eleição', 'verbose_name_plural': 'Eleições', 'ordering': ['-edital__data_resultado_final']},
        ),
        migrations.CreateModel(
            name='Voto',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('data_voto', djtools.db.models.DateTimeFieldPlus(auto_now_add=True, verbose_name='Data do Voto')),
                ('ip', models.GenericIPAddressField(verbose_name='IP da Origem do Voto')),
                ('hash', djtools.db.models.CharFieldPlus(blank=True, max_length=255, verbose_name='Hash')),
                ('string_hash', models.TextField(blank=True, verbose_name='String formadora do hash')),
                ('valido', models.BooleanField(default=True, verbose_name='Ativo')),
                ('justificativa_avaliacao', models.TextField(blank=True, verbose_name='Justificativa da Avaliação')),
                (
                    'campus',
                    djtools.db.models.ForeignKeyPlus(
                        on_delete=django.db.models.deletion.CASCADE, to='rh.UnidadeOrganizacional', verbose_name='Campus do Eleitor no Momento do Voto'
                    ),
                ),
                ('candidato', djtools.db.models.ForeignKeyPlus(null=True, on_delete=django.db.models.deletion.CASCADE, to='eleicao.Candidato')),
                ('chapa', djtools.db.models.ForeignKeyPlus(null=True, on_delete=django.db.models.deletion.CASCADE, to='eleicao.Chapa')),
                ('eleicao', djtools.db.models.ForeignKeyPlus(null=True, on_delete=django.db.models.deletion.CASCADE, to='eleicao.Eleicao', verbose_name='Eleição')),
                (
                    'eleitor',
                    djtools.db.models.CurrentUserField(
                        blank=True,
                        default=djtools.middleware.threadlocals.get_user,
                        editable=False,
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={'verbose_name': 'Voto', 'verbose_name_plural': 'Votos', 'permissions': (('validar_voto', 'Pode validar voto'),)},
        ),
        migrations.AddField(
            model_name='chapa', name='eleicao', field=djtools.db.models.ForeignKeyPlus(on_delete=django.db.models.deletion.CASCADE, to='eleicao.Eleicao', verbose_name='Eleição')
        ),
        migrations.AddField(
            model_name='candidato', name='chapa', field=djtools.db.models.ForeignKeyPlus(null=True, on_delete=django.db.models.deletion.CASCADE, to='eleicao.Chapa')
        ),
        migrations.AddField(
            model_name='candidato',
            name='eleicao',
            field=djtools.db.models.ForeignKeyPlus(null=True, on_delete=django.db.models.deletion.CASCADE, to='eleicao.Eleicao', verbose_name='Eleição'),
        ),
        migrations.AlterUniqueTogether(name='chapa', unique_together=set([('eleicao', 'nome')])),
        migrations.AlterUniqueTogether(name='candidato', unique_together=set([('eleicao', 'candidato_vinculo')])),
    ]

# Configuration file for the Sphinx documentation builder.
#
# This file only contains a selection of the most common options. For a full
# list see the documentation:
# https://www.sphinx-doc.org/en/master/usage/configuration.html

# -- Path setup --------------------------------------------------------------

# If extensions (or modules to document with autodoc) are in another directory,
# add these directories to sys.path here. If the directory is relative to the
# documentation root, use os.path.abspath to make it absolute, like shown here.
#
import inspect
import os
import sys
from django.core.wsgi import get_wsgi_application

sys.path.insert(0, os.path.abspath('../'))
os.environ.setdefault("DJANGO_SETTINGS_MODULE", "suap.settings")
application = get_wsgi_application()

# -- Project information -----------------------------------------------------

project = 'SUAP - Docs'
copyright = '2020, COSINF/DIGTI/IFRN'
author = 'COSINF/DIGTI/IFRN'

undoc_file = './undoc.txt'

if os.path.isfile(undoc_file):
    os.remove(undoc_file)

# The full version, including alpha/beta/rc tags
release = '1.0'


# -- General configuration ---------------------------------------------------

# Add any Sphinx extension module names here, as strings. They can be
# extensions coming with Sphinx (named 'sphinx.ext.*') or your custom
# ones.
extensions = [
    'sphinx.ext.autodoc',         # The autodoc core
    'sphinx.ext.graphviz',        # Support creating charts!
    'sphinx.ext.napoleon',        # Suport for NumPy and Google style
    # 'sphinxcontrib_django',       # this module
]

# Autodoc configurations
# autodoc_default_options = {
#     'members':         True,
#     'member-order':    'bysource',
#     'special-members': '__init__',
#     'undoc-members':   True,
# }

# Add any paths that contain templates here, relative to this directory.
templates_path = ['_templates']

# The language for content autogenerated by Sphinx. Refer to documentation
# for a list of supported languages.
#
# This is also used if you do content translation via gettext catalogs.
# Usually you set "language" from the command line for these cases.
language = 'pt_BR'

# List of patterns, relative to source directory, that match files and
# directories to ignore when looking for source files.
# This pattern also affects html_static_path and html_extra_path.
exclude_patterns = ['_build', 'Thumbs.db', '.DS_Store']


# -- Options for HTML output -------------------------------------------------

# The theme to use for HTML and HTML Help pages.  See the documentation for
# a list of builtin themes.
#
html_theme = 'classic'   # 'alabaster'

# Add any paths that contain custom static files (such as style sheets) here,
# relative to this directory. They are copied after the builtin static files,
# so a file named "default.css" will overwrite the builtin "default.css".
html_static_path = ['_static']

# Napoleon settings
napoleon_google_docstring = True
napoleon_numpy_docstring = True
napoleon_include_init_with_doc = False
napoleon_include_private_with_doc = False
napoleon_include_special_with_doc = True
napoleon_use_admonition_for_examples = False
napoleon_use_admonition_for_notes = False
napoleon_use_admonition_for_references = False
napoleon_use_ivar = False
napoleon_use_param = True
napoleon_use_rtype = True


def find_skiped_members(app, what, name, obj, skip, options):

    if skip:
        try:
            obj_path = inspect.getfile(obj)
            qualname = obj.__qualname__
            if 'suap' in obj_path \
               and 'envs' not in obj_path \
               and not obj_path.endswith('pyc'):
                with open('./undoc.txt', 'a') as fd:
                    fd.write(f'[{obj.__module__}] {qualname}\n')
        except Exception:
            pass
    return skip


def setup(app):
    app.connect('autodoc-skip-member', find_skiped_members)


"""
https://www.sphinx-doc.org/en/master/usage/extensions/napoleon.html

Docstring Sections
All of the following section headers are supported:

Args (alias of Parameters)
Arguments (alias of Parameters)
Attention
Attributes
Caution
Danger
Error
Example
Examples
Hint
Important
Keyword Args (alias of Keyword Arguments)
Keyword Arguments
Methods
Note
Notes
Other Parameters
Parameters
Return (alias of Returns)
Returns
Raises
References
See Also
Tip
Todo
Warning
Warnings (alias of Warning)
Warns
Yield (alias of Yields)
Yields
"""
